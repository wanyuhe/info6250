{"version":3,"file":"bundle.js","mappings":"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","sources":["webpack://project2/./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://project2/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://project2/./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://project2/./node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://project2/./src/constants.js","webpack://project2/./src/state.js","webpack://project2/./src/services.js","webpack://project2/./node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","webpack://project2/./src/render.js","webpack://project2/./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","webpack://project2/./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","webpack://project2/./node_modules/@babel/runtime/helpers/esm/iterableToArray.js","webpack://project2/./node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","webpack://project2/./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","webpack://project2/./src/main.js","webpack://project2/./src/listener.js"],"sourcesContent":["export default function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}","import toPropertyKey from \"./toPropertyKey.js\";\nexport default function _defineProperty(obj, key, value) {\n  key = toPropertyKey(key);\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nexport default function toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : String(i);\n}","import _typeof from \"./typeof.js\";\nexport default function toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}","export const SERVER = {\n    AUTH_MISSING: 'auth-missing',\n    AUTH_INSUFFICIENT: 'auth-insufficient',\n    REQUIRED_USERNAME: 'required-username',\n    REQUIRED_TASK: 'required-task',\n};\n\nexport const CLIENT = {\n    NETWORK_ERROR: 'networkError',\n    NO_SESSION: 'noSession',\n};\n\nexport const MESSAGES = {\n    [CLIENT.NETWORK_ERROR]: 'Trouble connecting to the network.  Please try again',\n    [SERVER.AUTH_INSUFFICIENT]: 'Your username/password combination does not match any records, please try again.',\n    [SERVER.REQUIRED_USERNAME]: 'Please enter a valid (letters and/or numbers) username',\n    default: 'Something went wrong.  Please try again',\n};","import { MESSAGES } from './constants';\n\nconst state = {\n    isLoggedIn: false,\n    isLoginPending: false,\n    isMessagePending: false,\n    messages: [],\n    sessions: {},\n    username: '',\n    error: '',\n};\n\nexport function waitOnLogin() {\n    state.isLoggedIn = false;\n    state.isLoginPending = true;\n    state.username = '';\n    state.messages = {};\n    state.error = '';\n}\n\nexport function login(username) {\n    state.isLoggedIn = true;\n    state.isLoginPending = false;\n    state.username = username;\n    state.messages = {};\n    state.error = '';\n}\n\nexport function logout() {\n    state.isLoggedIn = false;\n    state.isLoginPending = false;\n    state.username = '';\n    state.messages = {};\n    state.error = '';\n}\n\nexport function waitOnMessages() {\n    state.Messages = {};\n    state.isMessagePending = true;\n    state.error = '';\n}\n\nexport function setMessages(messages) {\n    state.messages = messages.chatMessages;\n    state.sessions = messages.users;\n    state.isMessagePending = false;\n    state.error = '';\n}\n\nexport function addMessage(message) {\n    state.messages.push(message);\n    state.error = '';\n}\n\nexport function setError(error) {\n    if(!error) {\n        state.error = '';\n        return;\n    }\n    state.isLoginPending = false;\n    state.error = MESSAGES[error] || MESSAGES.default;\n}\n\nexport default state;\n\n","export function fetchSession() {\n    return fetch('/api/session', {\n        method: 'GET',\n    })\n        .catch( () => Promise.reject({ error: 'networkError' }) )\n        .then( response => {\n            if (response.ok) {\n                return response.json();\n            }\n            return response.json()\n                .catch( error => Promise.reject({ error }) )\n                .then( err => Promise.reject(err) );\n        });\n}\n\n\n//refresh Messages\nexport function fetchMessages() {\n    return fetch('/api/messages')\n        .catch(() => Promise.reject({ error: 'networkError' }))\n        .then(response => {\n            if (response.ok) {\n                return response.json();\n            }\n            return response.json()\n                .catch(error => Promise.reject({ error }))\n                .then(err => Promise.reject(err));\n        });\n}\n\nexport function sendMessage(message) {\n    return fetch('/api/messages', {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify(message),\n    })\n        .catch(() => Promise.reject({ error: 'networkError' }))\n        .then(response => {\n            if (response.ok) {\n                return response.json();\n            }\n            return response.json()\n                .catch(error => Promise.reject({ error }))\n                .then(err => Promise.reject(err));\n        });\n}\n\nexport function fetchLogin(username) {\n    return fetch('/api/session', {\n        method: 'POST',\n        headers: new Headers({\n            'content-type': 'application/json'\n        }),\n        body: JSON.stringify({ username }),\n    })\n        .catch( () => Promise.reject({ error: 'networkError' }) )\n        .then( response => {\n            if (response.ok) {\n                return response.json();\n            }\n            return response.json()\n                .catch( error => Promise.reject({ error }) )\n                .then( err => Promise.reject(err) );\n        });\n}\n\nexport function fetchLogout() {\n    return fetch('/api/session', {\n        method: 'DELETE',\n    })\n        .catch(() => Promise.reject({ error: 'networkError' }))\n        .then(response => {\n            if (response.ok) {\n                return response.json();\n            }\n            return response.json()\n                .catch(error => Promise.reject({ error }))\n                .then(err => Promise.reject(err));\n        });\n}\n\n","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}","function render({ state, appEl }) {\n    const html = `\n   <main class=\"\">\n     ${generateStatusHtml(state)}\n     ${generateLoginHtml(state)}\n     ${generateContentHtml(state)}\n   </main>\n  `;\n    appEl.innerHTML = html;\n}\n\nfunction generateStatusHtml(state) {\n    return `\n      <div class=\"status\">${state.error}</div>\n  `;\n}\n\nfunction generateLoginHtml(state) {\n    if(state.isLoginPending) {\n        return `\n      <div class=\"login__waiting\">Logging in...</div>\n    `;\n    }\n    if(state.isLoggedIn) {\n        return ``;\n    }\n    return `\n      <div class=\"login\">\n        <form class=\"login__form\">\n          <label>\n            <span>Username:</span>\n            <input class=\"login__username\" type=\"text\" value=\"\">\n          </label>\n          <button class=\"login__button\" type=\"submit\">Login</button>\n        </form>\n      </div>\n  `;\n}\n\nfunction generateContentHtml(state) {\n    if (!state.isLoggedIn) {\n        return ``;\n    }\n    if (state.isMessagePending) {\n        return `\n            <div class=\"content\">\n                ${generateControlsHtml(state)}\n                <div class=\"messages__waiting\">Loading messages...</div>\n            </div>\n        `;\n    }\n    return `\n        <div class=\"content\">\n            ${generateControlsHtml(state)}\n            <div class=\"messages-container\">\n            <ul class=\"messages\">${generateMessagesHtml(state)}</ul>\n            </div>\n            ${generateSendMessageHtml()}\n            ${generateUsersListHtml(state)}\n        </div>\n    `;\n}\n\n\nfunction generateControlsHtml(state) {\n    return `\n        <div class=\"controls\">\n            <button class=\"controls__refresh\">Refresh</button>\n            <button class=\"controls__logout\">Logout</button>\n        </div>\n    `;\n}\n\n\nfunction generateMessagesHtml(state) {\n    const messagesHtml = Object.values(state.messages).map(message => {\n        return `\n      <li class=\"message\">\n        <span class=\"message__author\">${message.username}:</span>\n        <span class=\"message__text\">${message.text}</span>\n      </li>\n    `;\n    }).join('');\n    return messagesHtml || `<p>No messages yetï¼Œ start the conversation!</p>`;\n}\n\nfunction generateSendMessageHtml() {\n    return `\n        <form class=\"send__form\">\n          <input class=\"send__input\" type=\"text\">\n          <button type=\"submit\" class=\"send__button\">Send</button>\n        </form>\n  `;\n}\n\nfunction generateUsersListHtml(state) {\n    const usernames = Object.values(state.sessions).map(user => user.username);\n    const uniqueUsernames = [...new Set(usernames)];\n    const usersListHtml = uniqueUsernames.map(username => {\n        return `\n            <li class=\"user\">${username}</li>\n        `;\n    }).join('') || `<p>No other users online.</p>`;\n    return `\n        <div class=\"users\">\n            <h3>Online Users</h3>\n            <ul class=\"users__list\">\n                ${usersListHtml}\n            </ul>\n        </div>\n    `;\n}\n\nexport default render;\n","import arrayWithoutHoles from \"./arrayWithoutHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableSpread from \"./nonIterableSpread.js\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import { SERVER, CLIENT } from './constants';\nimport state, {\n    login,\n    logout,\n    waitOnMessages,\n    setMessages,\n    setError,\n} from './state';\n\nimport {\n    fetchSession,\n    fetchMessages,\n} from './services';\n\nimport render from './render';\nimport {\n    addAbilityToLogin,\n    addAbilityToLogout,\n    addAbilityToSendMessage,\n    addAbilityToRefresh,\n    refreshPage,\n} from './listener';\n\nconst appEl = document.querySelector('#app');\naddAbilityToLogin({ state, appEl }); \naddAbilityToLogout({ state, appEl });\naddAbilityToSendMessage({ state, appEl });\naddAbilityToRefresh({ state, appEl });\ncheckForSession();\n\nsetInterval(() => refreshPage({ state, appEl }), 5000);\n\nfunction checkForSession() {\n    fetchSession()\n        .then(session => {\n            login(session.username);\n            render({ state, appEl });\n            return fetchMessages()\n        })\n        .catch(err => {\n            if (err?.error === SERVER.AUTH_MISSING) {\n                return Promise.reject({ error: CLIENT.NO_SESSION });\n            }\n            return Promise.reject(err);\n        })\n        .then(messages => {\n            setMessages(messages);\n            render({ state, appEl });\n        })\n        .catch(err => {\n            if (err?.error == CLIENT.NO_SESSION) {\n                logout();\n                render({ state, appEl });\n                return;\n            }\n            setError(err?.error || 'ERROR');\n            render({ state, appEl });\n        });\n}\n","import {\n    fetchMessages,\n    sendMessage,\n    fetchLogin,\n    fetchLogout,\n} from \"./services\";\n\nimport {\n    waitOnLogin,\n    login,\n    logout,\n    waitOnMessages,\n    setMessages,\n    addMessage,\n    setError,\n} from './state';\n\nimport render from './render';\n\n\nexport function addAbilityToLogin({ state, appEl }) {\n    appEl.addEventListener('submit', (e) => {\n        if (!e.target.classList.contains('login__form')) {\n            return;\n        }\n        e.preventDefault();\n\n        const username = appEl.querySelector('.login__username').value;\n        waitOnLogin();\n        render({ state, appEl });\n        fetchLogin(username)\n            .then(userSession => {\n                login(userSession.username);\n                return fetchMessages();  \n            })\n            .then(messages => {\n                setMessages(messages);\n                render({ state, appEl });\n            })\n            .catch(err => {\n                setError(err?.error || 'ERROR');\n                render({ state, appEl });\n            });\n    });\n}\n\nexport function addAbilityToLogout({ state, appEl }) {\n    appEl.addEventListener('click', (e) => {\n        if (!e.target.classList.contains('controls__logout')) {\n            return;\n        }\n        logout();\n        render({ state, appEl });\n        fetchLogout()\n            .catch(err => {\n                setError(err?.error || 'ERROR');\n                render({ state, appEl });\n            });\n    });\n}\n\nexport function addAbilityToRefresh({ state, appEl }) {\n    appEl.addEventListener('click', (e) => {\n        if (!e.target.classList.contains('controls__refresh')) {\n            return;\n        }\n\n        waitOnMessages();\n        render({ state, appEl });\n        fetchMessages()\n            .then(messages => {\n                setMessages(messages);\n                render({ state, appEl });\n            })\n            .catch(err => {\n                setError(err?.error || 'ERROR');\n                render({ state, appEl });\n            });\n    });\n}\n\nexport function refreshPage({ state, appEl }) {\n    if (state.isLoggedIn === false) {\n        return;\n    }\n    waitOnMessages();\n    fetchMessages()\n    .then(messages => {\n        setMessages(messages);\n        render({ state, appEl });\n    })\n    .catch(err => {\n        setError(err?.error || 'ERROR');\n        render({ state, appEl });\n    });\n}\n\nexport function addAbilityToSendMessage({ state, appEl }) {\n    appEl.addEventListener('submit', (e) => {\n        if (!e.target.classList.contains('send__form')) {\n            return;\n        }\n        e.preventDefault();\n        const messageInput = appEl.querySelector('.send__input'); \n        const messageText = messageInput.value;\n        sendMessage({ text: messageText })\n            .then(message => {\n                addMessage(message);\n                messageInput.value = '';  \n                render({ state, appEl });\n            })\n            .catch(err => {\n                setError(err?.error || 'ERROR');\n                render({ state, appEl });\n            });\n    });\n}\n\n"],"names":["_typeof","o","Symbol","iterator","constructor","prototype","_defineProperty","obj","key","value","i","t","r","e","toPrimitive","call","TypeError","String","Object","defineProperty","enumerable","configurable","writable","CLIENT","MESSAGES","state","isLoggedIn","isLoginPending","isMessagePending","messages","sessions","username","error","waitOnLogin","login","logout","waitOnMessages","Messages","setMessages","chatMessages","users","addMessage","message","push","setError","fetchMessages","fetch","Promise","reject","then","response","ok","json","err","_arrayLikeToArray","arr","len","length","arr2","Array","_ref","appEl","html","concat","generateStatusHtml","generateLoginHtml","values","map","text","join","generateMessagesHtml","usernames","user","usersListHtml","Set","isArray","iter","from","minLen","n","toString","slice","name","test","generateUsersListHtml","generateContentHtml","innerHTML","document","querySelector","addEventListener","target","classList","contains","preventDefault","render","method","headers","Headers","body","JSON","stringify","fetchLogin","userSession","addAbilityToLogin","_ref2","addAbilityToLogout","_ref5","messageInput","addAbilityToSendMessage","_ref3","addAbilityToRefresh","session","setInterval","_ref4","refreshPage"],"sourceRoot":""}